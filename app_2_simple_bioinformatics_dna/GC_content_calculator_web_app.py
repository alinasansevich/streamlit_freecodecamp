#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Jan 11 14:16:09 2021

@author: alina

GC Content Calculator Web App
"""

import pandas as pd
import streamlit as st
import altair as alt
from PIL import Image

# Page Title CONTINUE LATER XXXXXXXXXXXXXXXXXXXX
image = Image.open('GC-content_calculator.jpeg')

st.image(image, use_column_width=True)

st.write("""
# GC Content Calculator Web App

This app calculates the GC content of query DNA! XXXXXXX

***
""")

# Input Text Box

#st.sidebar.header('Enter DNA sequence')
st.header('Enter DNA sequence')


sequence_input = """>NM_119948.4 Arabidopsis thaliana phosphoenolpyruvate carboxykinase 1 (PCK1), mRNA
AGTCATCTTTATAAACCACCGGTTATGTTAAGAGAGAAAATAAAAATAAAAAAGGGGCTCTTCCTAGGAA
GATAGATCTTAACCATGGTTAACACTCTCACGGTTCATTATTAACCATGGTTCTAAAAATCTAACCTTTA
AAAAACCACTTTCGCTTCTCTTCACATTCGCATCATTTTGTATCATCCCTTGAAAACGTTAAATGATCTT
CTCCTCCGATCATTAGTCTCTTTAATCTTTCTCAGCCTCTTCTTGTTCGTGATCTCTCTTCCTCCGGAAA
AAGATGTCGGCCGGTAACGGAAATGCTACTAACGGTGACGGAGGGTTTAGTTTCCCTAAAGGACCGGTGA
TGCCGAAGATAACGACCGGAGCAGCAAAGAGAGGTAGCGGAGTCTGCCACGACGATAGTGGTCCGACGGT
GAATGCCACAACCATCGATGAGCTTCATTCGTTACAGAAGAAACGTTCTGCTCCTACCACACCGATCAAC
CAAAACGCCGCCGCTGCTTTTGCCGCCGTCTCCGAGGAGGAGCGTCAGAAGATTCAGCTTCAATCTATCA
GTGCATCGTTAGCATCGTTAACGAGAGAGTCAGGACCAAAGGTGGTGAGAGGAGATCCGGCGGAGAAGAA
GACCGATGGTTCAACTACTCCGGCGTACGCTCACGGCCAACATCATTCTATCTTTTCTCCGGCTACTGGT
GCTGTCAGTGATAGCTCCTTGAAGTTTACTCACGTCCTCTACAATCTTTCGCCTGCAGAGCTTTATGAGC
AAGCTATTAAGTATGAGAAAGGTTCGTTTATCACTTCTAATGGAGCTTTGGCGACGCTTTCTGGTGCTAA
GACTGGTCGTGCTCCCAGAGATAAGCGTGTTGTTAGAGATGCTACTACTGAGGATGAGCTTTGGTGGGGA
AAGGGTTCGCCGAATATCGAAATGGATGAACATACTTTCATGGTGAACAGAGAAAGAGCTGTTGATTACT
TGAATTCCTTGGAAAAGGTCTTTGTCAATGACCAATACTTAAACTGGGATCCAGAGAACAGAATCAAAGT
CAGGATTGTCTCAGCTAGAGCTTACCATTCATTGTTTATGCACAACATGTGTATCCGACCAACTCAGGAG
GAGCTTGAGAGCTTTGGTACTCCGGATTTTACTATATACAATGCTGGGCAGTTTCCATGTAATCGTTACA
CTCATTACATGACTTCGTCCACTAGCGTAGACCTTAATCTGGCTAGGAGGGAAATGGTTATACTTGGTAC
TCAGTATGCTGGGGAAATGAAGAAGGGTCTTTTCAGTGTGATGCATTACCTTATGCCTAAGCGTCGTATT
CTCTCCCTTCATTCTGGATGCAATATGGGAAAAGATGGAGATGTTGCTCTCTTCTTTGGACTTTCAGGTA
CCGGGAAGACAACGCTGTCTACTGATCACAACAGGTATCTTATTGGAGATGATGAGCATTGTTGGACTGA
GACTGGTGTTTCGAACATTGAGGGTGGGTGCTATGCTAAGTGTGTTGATCTTTCGAGGGAGAAGGAGCCT
GATATCTGGAACGCTATCAAGTTTGGAACAGTTTTGGAAAATGTTGTGTTTGATGAGCACACCAGAGAAG
TGGATTACTCTGATAAATCTGTTACAGAGAACACACGTGCTGCCTACCCAATTGAGTTCATTCCAAATGC
GAAAATACCTTGTGTTGGTCCACACCCGACAAATGTGATACTTCTGGCTTGTGATGCCTTTGGTGTTCTC
CCACCTGTGAGCAAGCTGAATCTGGCACAAACCATGTACCACTTCATCAGTGGTTACACTGCTCTGGTTG
CTGGCACAGAGGATGGTATCAAGGAGCCAACAGCAACATTCTCAGCTTGCTTTGGTGCAGCTTTCATAAT
GTTGCATCCCACAAAGTATGCAGCTATGTTAGCTGAGAAGATGAAGTCACAAGGTGCTACTGGTTGGCTC
GTCAACACTGGTTGGTCTGGTGGCAGTTATGGTGTTGGAAACAGAATCAAGCTGGCATACACTAGAAAGA
TCATCGATGCAATCCATTCGGGCAGTCTCTTGAAGGCAAACTACAAGAAAACCGAAATCTTTGGATTTGA
AATCCCAACTGAGATCGAAGGGATACCTTCAGAGATCTTGGACCCCGTCAACTCCTGGTCTGATAAGAAG
GCACACAAAGATACTCTGGTGAAACTGGGAGGTCTGTTCAAGAAGAACTTCGAGGTTTTTGCTAACCATA
AGATTGGTGTGGATGGTAAGCTTACGGAGGAGATTCTCGCTGCTGGTCCTATCTTTTAGAAAAACCAAAC
TCTGAATGATGTTGTCGAAAAGAAAGAAAGATCTACTATTATTAAGAAGAATAAAATGAGACTTTGTGTT
TTTCTTTGCTGTGATAATCTCTCTGAATAATAGAGAGAATTTAATGTTCCAAATGTGGTGCGATATGGAT
AATGATGATGACTATATGTAATTTATTACTATCCATCGTCATATATTTTTGTTGGGCCTTTGCCAACATT
TACATGATAGAACCAAGTACGAATAATATAAATTCTGGTCCAATCTGATGATGATTTTCAAAA
"""

#sequence = st.sidebar.text_area("Sequence input", sequence_input, height=250)
sequence = st.text_area("Sequence input", sequence_input, height=250)
sequence = sequence.splitlines()
sequence = sequence[1:] # Skips the sequence name (first line)
sequence = ''.join(sequence) # Concatenates list to string

st.write("""
***
""")

#####################################
# What is GC Content?

# GC content is usually calculated as a percentage value and sometimes called G+C ratio or GC-ratio. GC-content percentage is calculated as Count(G + C)/Count(A + T + G + C) * 100%.

# Why to care about GC Content?

# The GC pair is bound by three hydrogen bonds, while AT pairs are bound by two hydrogen bonds. And so,
# The GC content affects the stability of DNA.
# The GC content affects the secondary structure of mRNA.
# The GC content affects the annealing temperature for template DNA in PCR experiments.
# Where to apply the GC Content?

# The GC Content can be used in
# 1. primer design for PCR experiments
# 2. gene design from protein expression
# 3. mRNA hairpin prediction
# and etc.

#####################################
# Count(G + C)/Count(A + T + G + C) * 100%
def gc_content(window):
    """
    (str) -> int
    Returns the GC content of window (a DNA or RNA sequence).
    """
    gc = window.count('G') + window.count('C')
    atgc = window.count('A') + window.count('T') + window.count('G') + window.count('C')
    
    return (gc/atgc) * 100

# "Walk" over the sequence and calculate the GC content for each 30 nucleotide window
all_gc = []
for i in range(len(sequence) - 30):
    seq = sequence[i:i+30]
    gc_cont = gc_content(seq)
    all_gc.append(gc_cont)




# add something like this:
# Summary: Full Length(2583bp) | A(28% 724) | T(29% 739) | G(23% 598) | C(20% 522)



# gc content distribution graph